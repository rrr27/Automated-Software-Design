<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><head><meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type"><title>Running Bear Manual</title></head> <body><h1 style="text-align: center;"><span style="font-family: Helvetica,Arial,sans-serif;">Running Bear <img style="width: 59px; height: 61px;" alt="" src="figures/RunningBear.jpg" align="middle"> Manual</span></h1><div style="text-align: center;"><a href="mailto:batory@cs.utexas.edu"><span style="font-family: Helvetica,Arial,sans-serif;">Don Batory</span></a><br style="font-family: Helvetica,Arial,sans-serif;"><span style="font-family: Helvetica,Arial,sans-serif;">Department of Computer Science</span><br style="font-family: Helvetica,Arial,sans-serif;"><span style="font-family: Helvetica,Arial,sans-serif;">The University of Texas at Austin</span><br style="font-family: Helvetica,Arial,sans-serif;"><span style="font-family: Helvetica,Arial,sans-serif;">Austin, TX, USA</span><br style="font-family: Helvetica,Arial,sans-serif;"></div><span style="font-family: Helvetica,Arial,sans-serif;"></span><br style="font-family: Helvetica,Arial,sans-serif;"><span style="font-family: Helvetica,Arial,sans-serif;"><span style="font-weight: bold;">Running Bear (RB)</span> is a MDELite's <span style="font-weight: bold;">Model-to-Text (M2T)</span> tool. &nbsp; &nbsp;It is a tiny Java file that offers <span style="font-weight: bold;">8</span> </span><span style="font-family: Helvetica,Arial,sans-serif;"><span style="font-weight: bold;">static</span> methods, of which the most important are the last two.<br><br></span><table style="width: 1107px; height: 277px; text-align: left; margin-left: auto; margin-right: auto;" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td style="font-family: Helvetica,Arial,sans-serif; text-align: center; font-weight: bold;">Return Type</td><td style="font-family: Helvetica,Arial,sans-serif; font-weight: bold;">Method</td><td style="font-family: Helvetica,Arial,sans-serif; font-weight: bold;">Usage</td></tr><tr><td style="text-align: center; font-family: monospace; font-weight: bold;"><big>void</big></td><td style="font-family: monospace; font-weight: bold;"><big>RBSetup(Marquee2Arguments mark, String... args)</big></td><td style="font-family: Helvetica,Arial,sans-serif;">Open the command-line specified database and output file</td></tr><tr><td style="text-align: center; font-family: monospace; font-weight: bold;"><big>void</big></td><td style="font-family: monospace; font-weight: bold;"><big>openOut(String filename)</big></td><td style="font-family: Helvetica,Arial,sans-serif;">direct RB output to the given file</td></tr><tr><td style="font-family: monospace; font-weight: bold; text-align: center;"><big>void</big></td><td style="font-family: monospace; font-weight: bold; text-align: left;"><big>openOut(PrintStream o)</big></td><td><span style="font-family: Helvetica,Arial,sans-serif;">direct RB output to the given PrintStream</span></td></tr><tr><td style="font-family: monospace; font-weight: bold; text-align: center;"><big>void</big></td><td style="font-family: monospace; font-weight: bold; text-align: left;"><big>closeOut()</big></td><td style="font-family: Helvetica,Arial,sans-serif;">close the opened RB PrintStream or file</td></tr><tr><td style="font-family: monospace; font-weight: bold; text-align: center;"><big>String</big></td><td style="font-family: monospace; font-weight: bold; text-align: left;"><big>getDatabase()</big></td><td style="font-family: Helvetica,Arial,sans-serif;">return the filename of the current database</td></tr><tr><td style="font-family: monospace; font-weight: bold; text-align: center;"><big>String</big></td><td style="font-family: monospace; font-weight: bold; text-align: left;"><big>getOutputFileName()</big></td><td style="font-family: Helvetica,Arial,sans-serif;">return the file name of the current output file</td></tr><tr><td style="text-align: center; font-family: monospace; font-weight: bold;"><big>void</big></td><td style="font-family: monospace; font-weight: bold;"><big>p(String format, Object... args)</big></td><td style="font-family: Helvetica,Arial,sans-serif;">print(format,arguments) no line eject</td></tr><tr><td style="text-align: center; font-family: monospace; font-weight: bold;"><big>void</big></td><td style="font-family: monospace; font-weight: bold;"><big>l(String format, Object... args)</big></td><td style="font-family: Helvetica,Arial,sans-serif;">printline(format, arguments) with line ej</td></tr></tbody></table><span style="font-family: Helvetica,Arial,sans-serif;"></span><span style="font-family: Helvetica,Arial,sans-serif;"><span style="font-weight: bold;"></span></span><h2><span style="font-family: Helvetica,Arial,sans-serif;">Outline of an RB Program</span><span style="font-family: Helvetica,Arial,sans-serif;"></span><span style="font-family: Helvetica,Arial,sans-serif;"></span></h2><span style="font-family: Helvetica,Arial,sans-serif;">An RB program&nbsp;implements a M2T tool. &nbsp;It maps an MDELite database to a text file (which could be a java file, html file, or whatever). &nbsp;The command-line of an RB program is standardized:<br></span><span style="font-family: Helvetica,Arial,sans-serif;"></span><pre style="margin-left: 40px;"><big><span style="font-family: monospace; font-weight: bold;">&gt; java myRBProgram X.Y.pl [outputfile]</span></big></pre><span style="font-family: Helvetica,Arial,sans-serif;">That is, an RB program takes a database file as input (<span style="font-weight: bold;">X</span> is the name of the file, <span style="font-weight: bold;">Y</span> is the name of its schema, <span style="font-weight: bold;">pl</span> designates a MDELite database), and optionally the name of an output file. &nbsp;As we'll see shortly, the output file name is computed from the input file name, and the computation is specified in the RBSetup method. &nbsp;For debugging purposes, I specify an explicit output file (say "out.txt") to avoid output file proliferation. &nbsp;The basic template of a RB program is:<br></span><span style="font-family: Helvetica,Arial,sans-serif;"></span><pre style="margin-left: 40px;"><span style="font-family: monospace;"><big style="font-weight: bold;">import MDELite.Marquee2Arguments;<br>import MDELite.RunningBear;<br>import PrologDB.Table;<br>import PrologDB.Tuple;<br><br>public class demo extends RunningBear {<br>    static Table cls, fld;<br><br>    public static void main(String... args) {<br>        // Step 1: standard marquee processing<br>        Marquee2Arguments mark = new Marquee2Arguments(demo.class, ".classes.pl", ".txt", args);<br>        RBSetup(mark, args); // opens "X.classes.pl" database, as specified on the command line<br>                             // variable db is the opened database<br>                             // file "X.java" is opened (or whatever command-line output is specified<br>        <br>        // Step 2: open tables of database<br>        cls = db.getTableEH("class");<br>        fld = db.getTableEH("field");<br>        <br>        // Step 3: "generate" code ...<br><br>}</big></span></pre><h2><span style="font-family: Helvetica,Arial,sans-serif;"></span><span style="font-family: Helvetica,Arial,sans-serif;">Simple Example</span></h2><span style="font-family: Helvetica,Arial,sans-serif;">Here is a simple database:<br></span><span style="font-family: Helvetica,Arial,sans-serif;"></span><pre style="margin-left: 40px;"><big><span style="font-family: monospace; font-weight: bold;">dbase(classes,[class,field]).

table(class,[cid,name,superName]).
class(c0,entity,null).
class(c1,student,entity).
class(c2,course,entity).

table(field,[fid,name,type,cid]).
field(f0,name,String,c0).
field(f1,UTEID,String,c1).
field(f2,profName,String,c2). </span></big></pre><span style="font-family: Helvetica,Arial,sans-serif;">Here is the desired output:</span><span style="font-family: Helvetica,Arial,sans-serif;"><br></span><span style="font-family: Helvetica,Arial,sans-serif;"></span><pre style="margin-left: 40px; font-weight: bold;"><big><span style="font-family: monospace;">class entity  {
   String name;
}

class student extends entity {
   String UTEID;
}

class course extends entity {
   String profName;
} </span></big></pre><span style="font-family: Helvetica,Arial,sans-serif;">The extra code that is added to the template above to generate this is:<br></span><span style="font-family: Helvetica,Arial,sans-serif;"></span><pre style="margin-left: 40px;"><big><span style="font-family: monospace; font-weight: bold;">        cls.forEach(c->genClass(c,false));<br>        <br>        // Step 4: done<br>    }<br><br>    static void genClass(Tuple c, boolean separateFile) {<br>        // Step 1: print the class header<br>        String sup = c.get("superName");<br>        String xtends = (!sup.equals("null"))?"extends "+sup:"";<br>        if (separateFile) {<br>            openOut(c.get("name")+".java");<br>        }<br>        l("class %s %s {", c.get("name"), xtends);<br>        <br>        // Step 2: compute table of c's fields<br>        Table cfields = c.rightSemiJoin("cid",fld,"cid"); <br>        <br>        // Step 3: declare all fields and their types<br>        cfields.forEach(f-> l("   %s %s;", f.get("type"), f.get("name")));<br>        <br>        // Step 4: print the class footer<br>        l("}");<br>        l(1);    <br>        if (separateFile) {<br>            closeOut();<br>        }<br>    }<br></span></big></pre><span style="font-family: Helvetica,Arial,sans-serif;">By invoking method </span><span style="font-family: monospace;">genclass</span><span style="font-family: Helvetica,Arial,sans-serif;"> with </span><span style="font-family: monospace;">true</span><span style="font-family: Helvetica,Arial,sans-serif;">, separate .java files will be produced per class. &nbsp;That's about it.</span><span style="font-family: Helvetica,Arial,sans-serif;"></span></body></html> 
